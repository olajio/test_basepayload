    base_payload = "{\n  \"size\": 0,\n  \"sort\": [\n    {\n      \"_score\": {\n        \"order\": \"desc\"\n      }\n    }\n  ],\n  \"_source\": {\n        \"includes\": [ \"beats_state.beat.host\" ]\n  },\n  \"query\": {\n    \"bool\": {\n      \"must\": [\n\t\t\t\t{\n          \"bool\": {\n            \"must\": [\n              {\n                \"bool\": {\n                  \"must_not\": {\n                    \"bool\": {\n                      \"should\": [\n                        {\n                          \"query_string\": {\n                            \"fields\": [\n                              \"beats_state.beat.name.keyword\"\n                            ],\n                            \"query\": \"CS51*\"\n                          }\n                        }\n                      ],\n                      \"minimum_should_match\": 1\n                    }\n                  }\n                }\n              },\n              {\n                \"bool\": {\n                  \"must_not\": {\n                    \"bool\": {\n                      \"should\": [\n                        {\n                          \"query_string\": {\n                            \"fields\": [\n                              \"beats_state.beat.name.keyword\"\n                            ],\n                            \"query\": \"ip-*\"\n                          }\n                        }\n                      ],\n                      \"minimum_should_match\": 1\n                    }\n                  }\n                }\n              },\n              {\n                \"bool\": {\n                  \"must_not\": {\n                    \"bool\": {\n                      \"should\": [\n                        {\n                          \"query_string\": {\n                            \"fields\": [\n                              \"beats_state.beat.name.keyword\"\n                            ],\n                            \"query\": \"CW51-*\"\n                          }\n                        }\n                      ],\n                      \"minimum_should_match\": 1\n                    }\n                  }\n                }\n              }\n            ]\n          }\n        }\n\t\t\t],\n      \"filter\": [\n        {\n          \"range\": {\n            \"timestamp\": {\n              \"gte\": \"now-5d\",\n              \"lt\": \"now\"\n            }\n          }\n        },\n        {\n          \"bool\": {\n            \"should\": [\n              {\n                \"match_phrase\": {\n                  \"beats_state.beat.type\": \"metricbeat\"\n                }\n              },\n              {\n                \"match_phrase\": {\n                  \"beats_state.beat.type\": \"filebeat\"\n                }\n              }\n            ],\n            \"minimum_should_match\": 1\n          }\n        },\n\t\t\t\t{\n          \"match_phrase\": {\n            \"status\": \"down\"\n          }\t\t\t\t\t\n        },\n\t\t\t\t{\n          \"match_phrase\": {\n            \"beats_state.state.host.os.platform\": \"%s\"\n          }\t\t\t\t\t\n        },   \n		{\n          \"exists\": {\n            \"field\": \"timestamp\"\n          }\n        }\n      ],\n      \"should\": [],\n      \"must_not\": []\n    }\n  },\n  \"aggs\": {\n    \"uhosts\": {\n      \"terms\": {\n        \"field\": \"beats_state.beat.name.keyword\",\n\t\t\t\t\"size\": 2000\n      }\n    }\n  }\n\n}"
